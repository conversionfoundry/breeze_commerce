<div class="categories-container container">
  <p>These are your current available categories ready for your online store</p>
  <table class="fancy sortable contextual categories">
    <thead>
      <tr>
        <th class="first" style="">Name</th>
        <th style="">Slug</th>
        <th style="width:20%;">Available?</th>
        <th class="last" style="width: 160px;">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if categories.any? %>
        <%= render :partial => "category", :collection => categories %>
      <% else %>
        <tr><td class="empty" colspan="4">There are no categories to show here.</td></tr>
      <% end %>
    </tbody>
    <tfoot>
      <tr>
      </tr>
    </tfoot>
  </table>
</div>

<script type="text/javascript">
  $(function() {
    $('.available-toggle').live('mousedown', function() {
      $checkbox =  $(this).siblings('.category-available');
      $checkbox.click().change();
      checked = $(this).siblings('.category-available:checked').length > 0;
      $(this).animate({
        'background-position': (checked ? 0 : 100) + '% 0%'
        }, 'slow', 'easeInOutQuad');
      $(this).parents('.available').find('.text').html(checked ? 'Yes' : 'No');
      id = $(this).closest('tr.category').attr('data-id');
      $.ajax({
        url: '/admin/store/categories/' + id + '.js',
          type: 'post',
          dataType: 'script',
          data: '_method=put&category[available]=' + checked
        });

    });
   });
 </script>
